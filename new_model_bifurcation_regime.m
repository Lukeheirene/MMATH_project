clear
close all
clc

%Variables
kinfty = 52e-6;
Ve = 1e-6;
g = 0.5;

%non-dimensional variables
K1 = 4.88566;
K2 = 0.1;
K3 = 0.05;
options = optimset('Display','iter');

%Hopf bifurcations
fun = @(c) (((2*K1*c)/((K2^2) + (c^2)))*(1/(1 + ((((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))^4)*(c^4))))*(1 - ((c^2)/((K2^2) + (c^2))))) + (((2*c)/((K3^2) + (c^2)))*(((c^2)/((K3^2) + (c^2))) - 1)) -1 ;
x0 = 0.1;
z = fzero(fun,x0,options);
K4 = (((K1-1)*(z^2) - (K2^2) + (K1*(K3^2)))/((z^6) + ((K2^2)*(z^4))))^(1/4);
p = ((Ve)/((g*K4*kinfty) - Ve))^(1/4);

%Determinant
fun1 = @(c) (((2*K1*c)/((K2^2) + (c^2)))*(1/(1 + ((((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))^4)*(c^4))))*(((2*c)/((K3^2) + (c^2))) -1)) + (((2*c)/((K3^2) + (c^2)))*(1 - ((c^2)/((K3^2) + (c^2))))) + (((K1*(c^2))/((K3^2) + (c^2)))*((4*((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))*(c^3))/(((1 + ((((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))^4)*(c^4)))^2))));
x1 = 0.001;
z1 = fzero(fun1,x1);
K4 = (((K1-1)*(z1^2) - (K2^2) + (K1*(K3^2)))/((z1^6) + ((K2^2)*(z1^4))))^(1/4);
p = ((Ve)/(((g*kinfty)*K4) - Ve))^(1/4);

%Discriminant
fun2 = @(c) (((((2*K1*c)/((K2^2) + (c^2)))*(1/(1 + ((((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))^4)*(c^4))))*(1 - ((c^2)/((K2^2) + (c^2))))) + (((2*c)/((K3^2) + (c^2)))*(((c^2)/((K3^2) + (c^2))) - 1)) -1)^2) - 4*((((2*K1*c)/((K2^2) + (c^2)))*(1/(1 + ((((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))^4)*(c^4))))*(((2*c)/((K3^2) + (c^2))) -1)) + (((2*c)/((K3^2) + (c^2)))*(1 - ((c^2)/((K3^2) + (c^2))))) + (((K1*(c^2))/((K3^2) + (c^2)))*((4*((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))*(c^3))/(((1 + ((((((K1-1)*(c^2) - (K2^2) + (K1*(K3^2)))/((c^6) + ((K2^2)*(c^4))))^(1/4))^4)*(c^4)))^2)))));
x2 = 0.01;
z2 = fzero(fun2,x2);
K4 = (((K1-1)*(z2^2) - (K2^2) + (K1*(K3^2)))/((z2^6) + ((K2^2)*(z2^4))))^(1/4);
p = ((Ve)/(((g*kinfty)*K4) - Ve))^(1/4);


